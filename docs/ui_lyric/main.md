# 阶段一：需求分析 (What to Build?)
这个阶段的目标是明确你要开发什么，以及它应该具备哪些功能。

## 1.1 核心功能定义：
- 目标： 根据当前播放音乐名匹配是否存在同名LRC文件，存在则渲染歌词页面。
- 任务：
  - 显示歌词。
  - 歌词能随着音乐播放进度同步滚动/高亮。

## 1.2 详细功能描述：
- 目标： 细化核心功能，考虑各种情况。
- 任务：
  - 歌词来源： 歌词文件优先在音乐文件所在目录查找，也可以手动指定。先完成音乐文件目录查找的默认功能
  - 歌词格式： 支持普通时间戳+行歌词的格式，以及增强型时间戳+逐字时间戳格式，但是后者也仅解析为时间戳+行歌词，不渲染为行歌词动态颜色渐变。
  - 同步方式： 考虑由后端来发送更新行信号，前端ui只管显示，每到行时间戳时则发送换行信号。
  - 显示效果： 歌词如何呈现？（例如：单行显示、多行滚动、当前行高亮、字体大小/颜色）。
  - 用户交互： 用户不能手动拖动歌词进度条，这部分功能需要提供从前端编辑lrc歌词的功能，暂时不在支持计划中

# 阶段二：设计 (How to Build It?)
这个阶段的目标是规划如何实现这些功能，包括技术选型和模块划分。

## 2.1 技术选型（如果需要）：

- 目标： 使用Model-View来实现，QStringListView。
- 任务：
  - 解析 LRC 文件的c++库已经编写完成
  - UI 框架中如何实现文本滚动和高亮？
    - QListView，自定义delegate来控制显示效果

2.2 模块划分：

目标： 将整个功能分解成独立的、可管理的小模块。

任务：

歌词加载/解析模块： 负责读取歌词文件，解析出歌词数据（时间戳和文本）。

输入： 歌词文件路径。

输出： 一个结构化的歌词数据集合（例如：List<LyricLine>，其中 LyricLine 包含 timestamp 和 text）。

歌词显示模块： 负责在界面上展示歌词。

输入： 当前播放时间，歌词数据集合。

输出： 更新界面上的歌词显示。

播放器集成模块： 负责将歌词功能与现有音乐播放器连接起来。

任务： 监听播放器进度变化事件，并将当前时间传递给歌词显示模块。

思考： 每个模块只做一件事，职责单一，方便测试和维护。

2.3 数据结构设计：

目标： 确定歌词数据在程序中如何存储。

任务：

定义一个 LyricLine 类或结构体，包含 timestamp (时间，例如毫秒) 和 text (歌词文本)。

歌词文件解析后，存储为一个 List<LyricLine>。

思考： 好的数据结构能让后续操作更简单高效。

2.4 接口/通信设计：

目标： 明确不同模块之间如何进行数据交换和调用。

任务：

歌词加载模块提供一个 load_lyrics(file_path) 方法。

歌词显示模块提供一个 update_lyrics_display(current_time, lyrics_data) 方法。

播放器主逻辑在播放进度变化时调用 update_lyrics_display。

思考： 清晰的接口定义有助于模块间的独立开发和集成。

阶段三：实现 (Code It!)
这个阶段是编写代码，将设计转化为实际功能。

3.1 模块独立开发：

目标： 逐个实现每个模块的功能。

任务：

先开发歌词加载/解析模块： 编写代码读取 LRC 文件，解析时间戳和文本，并返回你设计的数据结构。

再开发歌词显示模块： 编写代码在界面上显示歌词，并根据输入的时间和歌词数据高亮或滚动。

思考： 从最核心、最独立的模块开始，逐个击破。

3.2 模块集成：

目标： 将各个模块连接起来，形成完整的功能。

任务：

在播放器中调用歌词加载模块加载歌词。

在播放器进度更新时，调用歌词显示模块更新界面。

思考： 确保模块间的调用和数据传递正确无误。

3.3 代码规范与注释：

目标： 编写可读性强、易于维护的代码。

任务：

遵循一致的命名约定。

添加必要的注释，解释复杂逻辑。

保持代码整洁。

思考： 即使是小项目，良好的代码习惯也很重要。

阶段四：测试 (Does It Work?)
这个阶段是验证你的功能是否按预期工作，并修复问题。

4.1 单元测试（可选但推荐）：

目标： 验证每个独立模块的功能是否正确。

任务：

为歌词解析模块编写测试用例：输入不同格式的 LRC 文件，检查解析结果是否正确。

为歌词显示模块编写测试用例：输入不同的时间戳和歌词数据，检查显示是否正确。

思考： 单元测试能帮助你快速定位问题，尤其是在模块比较独立时。

4.2 集成测试：

目标： 验证所有模块集成后，整个歌词显示功能是否正常。

任务：

播放一首带歌词的歌曲，检查歌词是否同步显示。

尝试快进/快退，检查歌词是否能快速响应。

尝试播放没有歌词的歌曲，检查显示是否正确（例如显示“无歌词”）。

思考： 这是最接近用户实际使用场景的测试。

4.3 错误处理测试：

目标： 验证程序在遇到异常情况时能否正常处理。

任务：

尝试加载一个损坏的歌词文件。

尝试加载一个不存在的歌词文件。

思考： 健壮的程序能够优雅地处理错误。

阶段五：部署与维护 (Release & Improve)
这个阶段是发布你的功能，并根据反馈进行改进。

5.1 发布：

目标： 将新功能集成到你的音乐播放器中，并发布。

任务：

确保所有依赖都已包含。

编译/打包程序。

思考： 准备好你的程序，让别人可以使用。

5.2 收集反馈：

目标： 了解用户对新功能的看法。

任务：

自己使用，发现问题。

如果可能，请朋友或家人试用，收集他们的意见。

思考： 用户反馈是改进的重要来源。

5.3 迭代改进：

目标： 根据反馈和新的想法，持续改进功能。

任务：

修复发现的 Bug。

添加新的功能（例如：歌词编辑、歌词下载）。

优化性能。

思考： 软件开发是一个持续改进的过程。